# SIRIUS DIGITAL HACK 
## Решение команды =Григорий Рыбалка=
## Содержание

1. Состав команды
2. Описание проекта
3. Инструкция по развертке сайта
4. Описание файлов репозитория
5. Способы улучшения программы
## Состав команды

- **Завидов Егор Николаевич**
- **Кораблев Денис Андреевич**
- **Панфилов Павел Андреевич**
- **Петров Григорий Евгеньевич**
## Описание проекта
  Данный проект является решением задачи для "sirius digital hack".
В рамках решения задачи был создан сайт, который на основе таблицы с ответами на открытые вопросы строит гистограммы распределения ответов по кластерам, в которые данные ответы попадают.
На основе гистограмм также составляется отчет, включающий в себя анализ основных причин увольнений и рекомендации по решению проблем, связанных с увольнениями.

## Инструкция по развертке сайта
- скачать папку "site"
- после распаковки запустить app.py
- зайти в браузер и ввести http://localhost:5000/
- загрузить xlsx файл на сайт используя его интерфейс## Описание работы программы
- Ввиду ограничений по времени и железу, было выбрано отказаться от использования LLM и свести задачу к тривиальной.
- **Среднее время работы программы** 2 минуты на CPU
- **Рекомендуемое оборудование:** NVIDIA карты с поддержкой CUDA ядер (2 GB) для более быстрой обработки. Скорость обработки с помощью модели можно увеличить до 10 раз.

### Рабочий процесс:

1. **Подготовка датасета:** Начальный этап включает парсинг данных (стоит отметить, что предложения в датасете разделялись по точке) и извлечение предобученных векторов предложений из модели SBERT.
2. **Поиск похожих предложений в наборе данных:** Предобученные эмбеддинги кластеризуются алгоритмом Kmeans по метрике, пропорциональной косинусному расстоянию (деление на норму евклидовой метрики).
3. **Выбор примеров из кластеризированных областей:** В каждом из построенных кластеров находим множество векторов, близких к медианному вектору всего кластера.
4. **Подготовка промпта в LLM** С помощью opensource llm api в большую языковую модель отправляется строка, состоящая из ответов на вопросы, соответствующих множеству выбранных на предыдущем шаге векторов, разделенных специальным символом '\n'. Запросы сформированы так, чтобы модель анализировала причины ухода сотрудника и формировала отчет о возможных улучшениях условий труда (данный шаг занимает много времени из-за ограничений, накладываемых на количество запросов в секунду, купленный api тариф должен ускорить код в разы).
5. **Построение гистограмм** Считается отношение количества элементов для отдельного кластера к количеству всех элементов и на основе полученных данных строятся диаграммы распределения причин ухода.
6. **Отправка датасета боту в телеграм** Имеется возможность запустить проект с помощью телеграм-бота, который запустит обработку файла и сформирует готовый отчет в формате (.pdf).
7. **Отправка датасета на сайт** Имеется возможность запустить проект через локально развернутый сайт. После обработки датасета на сайте открывается страница с готовым отчетом.

## Описание файлов репозитория

- **app.py:** Реализует API составляющую проекта.
- **bert.py:** Обрабатывает *.txt файл с помощью LM модели.
- **bert_fine_tuning_for_cls.ipynb:** Содержит процесс обучения и обработки датасета.
- **bert_context_tuning.ipynb:** Попытки научить контексту оказались хуже, чем классика.
- **pdfoutline.py, project.py:** Отвечают за оцифровку и разметку PDF файлов.
- **upload_form.html**: Содержит форму для отправки PDF на обработку.

## Способы улучшения программы

1. **Детекция и удаления ш:** Добавление функции проверки на правописание. Текущие open-source spell-checker'ы не удовлетворили наши ожидания, поэтому можно дообучить небольшую модель.
2. **Оцифровка документов:** Улучшение процесса оцифровки. Текущий метод имеет небольшие недочеты.
3. **Управление заголовками:** Добавление или удаление цифр в заголовках и создание иерархии.
![BARSIK](https://github.com/victorsemipalatin/-sochi_2024-/blob/main/293046_O.png)


- вы автоматически окажетесь на странице с отчетом


